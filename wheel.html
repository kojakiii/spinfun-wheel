<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Pump Fun Wheel - Ultra Pro Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@600&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-pink: #ff00ff;
            --neon-blue: #00ffff;
            --gold: #ffcc00;
        }

        body { 
            background: radial-gradient(circle at center, #1a001a 0%, #000 100%); 
            color: white; font-family: 'Rajdhani', sans-serif; 
            margin: 0; padding: 15px; overflow: hidden; display: flex; flex-direction: column; align-items: center;
        }

        /* Status Box Premium */
        #status-box {
            background: rgba(255, 0, 255, 0.05);
            border: 2px solid var(--neon-pink);
            padding: 12px; border-radius: 15px;
            text-align: center; min-width: 480px; margin-bottom: 25px;
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.2), inset 0 0 15px rgba(255, 0, 255, 0.1);
            backdrop-filter: blur(5px);
        }

        .main-layout { display: flex; align-items: center; gap: 40px; }

        /* Left Side */
        .side-col { width: 240px; display: flex; flex-direction: column; gap: 20px; }
        .info-card {
            background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px; border-radius: 12px; text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        .rules-box { border-left: 4px solid var(--neon-blue); text-align: left; }
        .cooldown-label { 
            background: rgba(255, 255, 0, 0.15); border: 1px solid var(--gold); 
            color: var(--gold); font-weight: bold; padding: 6px; border-radius: 5px; margin-top: 10px; font-size: 14px;
        }

        /* THE PROFESSIONAL WHEEL */
        .wheel-area { position: relative; width: 450px; height: 450px; display: flex; align-items: center; justify-content: center; }
        
        .wheel-outer-rim {
            position: absolute; width: 440px; height: 440px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #333, #111, #444, #111, #333);
            box-shadow: 0 0 50px rgba(0, 0, 0, 1), 0 0 30px rgba(255, 0, 255, 0.3);
            z-index: 1;
        }

        .wheel-inner-glow {
            position: absolute; width: 405px; height: 405px;
            border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.1);
            z-index: 3; pointer-events: none;
            box-shadow: inset 0 0 40px rgba(0,0,0,0.5);
        }

        canvas { 
            width: 400px; height: 400px; border-radius: 50%; z-index: 2;
            transition: transform 6s cubic-bezier(0.15, 0, 0.05, 1);
        }

        .pointer {
            position: absolute; top: -15px; left: 50%; transform: translateX(-50%);
            width: 0; height: 0; border-left: 22px solid transparent; border-right: 22px solid transparent; 
            border-top: 45px solid var(--neon-pink); z-index: 100;
            filter: drop-shadow(0 0 15px var(--neon-pink));
        }

        .center-hub {
            position: absolute; width: 50px; height: 50px;
            background: radial-gradient(circle, #222, #000);
            border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 50%;
            z-index: 10; display: flex; align-items: center; justify-content: center;
        }

        /* Leaderboard Style */
        .leaderboard-box {
            background: rgba(0, 0, 0, 0.6); border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px; border-radius: 15px; min-width: 300px; height: 420px;
            backdrop-filter: blur(10px);
        }
        .leaderboard-box h2 { 
            font-family: 'Orbitron', sans-serif; color: var(--neon-pink); 
            text-shadow: 0 0 10px var(--neon-pink); margin-top: 0; font-size: 18px;
        }
        .lb-row { display: flex; justify-content: space-between; padding: 10px 5px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); }

        @keyframes win-pulse {
            0% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.02); filter: brightness(1.3) saturate(1.2); }
            100% { transform: scale(1); filter: brightness(1); }
        }
        .winner-active { animation: win-pulse 0.5s infinite; border-color: #00ff00 !important; }
    </style>
</head>
<body>

    <div id="status-box">
        <div id="status-text" style="font-size: 28px; font-weight: bold; font-family: 'Orbitron'; letter-spacing: 2px;">WAITING FOR PLAYERS...</div>
    </div>

    <div class="main-layout">
        <div class="side-col">
            <div class="info-card rules-box">
                <strong style="color: white; font-size: 18px;">HOW TO PLAY</strong><br>
                <p style="margin: 8px 0; color: var(--neon-blue);">Type <span style="background: rgba(0,255,255,0.2); padding: 2px 6px; border-radius: 4px; color: white;">join</span> in chat</p>
                <div class="cooldown-label">COOLDOWN: 30s</div>
            </div>
            
            <div class="info-card" style="border-top: 3px solid var(--gold);">
                <div style="font-size: 12px; color: #888; margin-bottom: 5px; text-transform: uppercase;">Last Winner</div>
                <div id="last-winner-name" style="font-size: 22px; font-weight: bold; color: var(--gold);">NONE</div>
                <div id="last-winner-prize" style="font-size: 16px; color: white;">--</div>
            </div>
        </div>

        <div class="wheel-area">
            <div class="wheel-outer-rim"></div>
            <div class="wheel-inner-glow"></div>
            <div class="center-hub"><div style="width: 10px; height: 10px; background: var(--neon-pink); border-radius: 50%; box-shadow: 0 0 10px var(--neon-pink);"></div></div>
            <div class="pointer"></div>
            <canvas id="wheel" width="400" height="400"></canvas>
        </div>

        <div class="leaderboard-box">
            <h2>üèÜ TOP PLAYERS</h2>
            <div id="leaderboard-content"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');
        
        // Culori mult mai luminate »ôi vibrante
        const sectors = [
            { label: "ZERO", color: "#111111", textColor: "#ff00ff" },
            { label: "20 PTS", color: "#005555", textColor: "#00ffff" },
            { label: "AIRDROP", color: "#ff00ff", textColor: "#ffffff" },
            { label: "100 PTS", color: "#222222", textColor: "#00ffff" },
            { label: "TRY AGAIN", color: "#00aaaa", textColor: "#000000" },
            { label: "JACKPOT", color: "#ffcc00", textColor: "#000000" },
            { label: "10 PTS", color: "#aa00aa", textColor: "#ffffff" },
            { label: "50 PTS", color: "#333333", textColor: "#ffffff" }
        ];

        let currentRotation = 0;
        let lastTs = 0;

        function drawWheel() {
            const arc = (2 * Math.PI) / sectors.length;
            const centerX = 200, centerY = 200, radius = 200;

            sectors.forEach((s, i) => {
                const angle = i * arc;
                
                // Fundal felie
                ctx.beginPath();
                ctx.fillStyle = s.color;
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, angle, angle + arc);
                ctx.fill();
                
                // Linie separatoare luminoasa
                ctx.strokeStyle = "rgba(255,255,255,0.2)";
                ctx.lineWidth = 2;
                ctx.stroke();

                // Text optimizat pentru lizibilitate
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(angle + arc/2);
                ctx.textAlign = "right";
                
                // Shadow pentru text (il face sa "sara" din fundal)
                ctx.shadowBlur = 8;
                ctx.shadowColor = "rgba(0,0,0,1)";
                ctx.fillStyle = s.textColor;
                ctx.font = "bold 20px 'Orbitron', sans-serif";
                
                // Render text cu contrast
                ctx.fillText(s.label, radius - 25, 8);
                ctx.restore();
            });
        }

        async function updateData() {
            try {
                const r = await fetch('result.txt?t=' + Date.now());
                const res = await r.text();
                const p = res.split(',');
                if(p.length === 4 && parseFloat(p[0]) > lastTs) {
                    lastTs = parseFloat(p[0]);
                    startSpin(parseInt(p[1]), p[2], p[3]);
                }

                const lbR = await fetch('leaderboard.json?t=' + Date.now());
                const lbData = await lbR.json();
                if(lbData) {
                    let sorted = Object.entries(lbData).sort((a,b)=>b[1]-a[1]).slice(0, 10);
                    let h = sorted.map(([n, v], i) => `
                        <div class="lb-row">
                            <span style="color:#888;">#${i+1} <span style="color:white; font-weight:bold;">${n}</span></span>
                            <span style="color:#ff00ff; font-weight:bold;">${v} PTS</span>
                        </div>`).join('');
                    if(document.getElementById('leaderboard-content').innerHTML !== h) 
                        document.getElementById('leaderboard-content').innerHTML = h;
                }
            } catch(e) {}
        }

        function startSpin(idx, user, prize) {
            const statusBox = document.getElementById('status-box');
            const statusText = document.getElementById('status-text');
            statusBox.classList.remove('winner-active');
            statusText.innerHTML = `<span style="color:var(--neon-blue)">${user.toUpperCase()}</span> IS SPINNING...`;
            
            const sectorDeg = 360 / sectors.length;
            const target = (idx * sectorDeg) + (sectorDeg / 2);
            currentRotation += (360 * 10) + (360 - target) - 90;
            canvas.style.transform = `rotate(${currentRotation}deg)`;

            setTimeout(() => {
                statusText.innerHTML = `<span style="color:#00ff00">${user.toUpperCase()} WON ${prize}!</span>`;
                statusBox.classList.add('winner-active');
                document.getElementById('last-winner-name').innerText = user.toUpperCase();
                document.getElementById('last-winner-prize').innerText = prize;
                setTimeout(() => { 
                    statusBox.classList.remove('winner-active');
                    statusText.innerText = "WAITING FOR PLAYERS..."; 
                }, 5000);
            }, 6000);
        }

        drawWheel();
        setInterval(updateData, 1000);
    </script>
</body>
</html>